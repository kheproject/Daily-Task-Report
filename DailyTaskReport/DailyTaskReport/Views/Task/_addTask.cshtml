<script>
    if ("@Session["_user"]" == "") {
        console.log("Session expired.");
        promptMsg("Current session has expired. <br /> Please login again", true);
    }
    else {
        toggleUIBlocker();
        $(function () {
            var ListCount = 0;
            $('#addTimeLine').on("click", function (e) {
                //if ($('input#tasks_0__taskLists_' + ListCount + '__timeFrom').val() != ""
                //   && $('input#tasks_0__taskLists_' + ListCount + '__timeTo').val() != ""
                //   && $('input#tasks_0__taskLists_' + ListCount + '__task').val() != "") {
                ListCount++;
                var timeForm = '<div class="container"><div class="col-xs-6 container"><div class="col-xs-12 container"><div class="col-xs-3">'
                             + 'Time'
                             + '</div><div class="col-xs-9">'
                             + '<input data-val="true" data-val-required="The timeFrom field is required." id="tasks_' + '0' + '__taskLists_' + ListCount + '__timeFrom" name="tasks[' + '0' + '].taskLists[' + ListCount + '].timeFrom" style="width: 40%;" type="time">'
                             + ' ─ '
                             + '<input data-val="true" data-val-required="The timeTo field is required." id="tasks_' + '0' + '__taskLists_' + ListCount + '__timeTo" name="tasks[' + '0' + '].taskLists[' + ListCount + '].timeTo" style="width: 40%;" type="time">'
                             + '</div></div><div class="col-xs-12 container"><div class="col-xs-3">'
                             + 'Work Order'
                             + '</div><div class="col-xs-9">'
                             + '<input data-val="true" data-val-length="invalid work order no." data-val-length-max="18" data-val-length-min="18" id="tasks_' + '0' + '__taskLists_' + ListCount + '__woNo" maxlength="18" name="tasks[' + '0' + '].taskLists[' + ListCount + '].woNo" placeholder="work order no." style="text-transform: uppercase; width: 86%; text-align: center;" type="text">'
                             + '</div></div></div><div class="col-xs-6 container"><div class="container"><div class="col-xs-2">'
                             + 'Task'
                             + '</div><div class="col-xs-10">'
                             + '<textarea cols="20" data-val="true" data-val-required="The task field is required." id="tasks_' + '0' + '__taskLists_' + ListCount + '__task" name="tasks[' + '0' + '].taskLists[' + ListCount + '].task" placeholder="description" rows="2" style="width: 100%; height: 100%; padding: 10px; resize: none;"></textarea>'
                             + '</div></div></div></div>'
                document.getElementById('todaystasks').insertAdjacentHTML('beforeend', timeForm);
                //}
                //else {
                //    alert("Fill out the form first");
                //}
            });
            //$('input[type="date"]').keydown(function (e) {
            //    console.log(this.id + " input " + (e.keyCode - 48))
            //    var currentInput = $(this).val();
            //    if (isBackSpace(e))
            //        console.log('backspace');
            //    else if ((!isNumber(e) && !isBackSpace(e) && !isArrowKeys(e) && !isTab(e) && !isDelete(e) && !isSelectAll(e))
            //       || ((e.keyCode == 48 || e.keyCode == 96) && currentInput.length == 1 && currentInput[0] == '0')
            //       || currentInput.length > 10)
            //        e.preventDefault();
            //    else if ((currentInput.length == 2 || currentInput.length == 5) && !isBackSpace(e))
            //        $(this).val(currentInput + '/');
            //}).focusout(function (e) {
            //    var bDateVal = $(this).val();
            //    bdate = false;
            //    if (bDateVal != "") {
            //        if (bDateVal[2] != '/' || bDateVal[5] != '/') {
            //            $(this).val('');
            //            $(this).focus();
            //            inputInvalid('birthdate', 'msgBDateError', 'Invalid date format');
            //        }
            //        else if (bDateVal.length < 10 ||
            //            parseInt(bDateVal.slice(0, 2)) > 12 || //if month > 12
            //            parseInt(bDateVal.slice(3, 5)) < 01 || //if days < 01
            //            parseInt(bDateVal.slice(3, 5)) > 31    //if days > 31
            //            ) {
            //            inputInvalid('birthdate', 'msgBDateError', 'Invalid date format');
            //        }
            //        else if (parseInt((new Date().getFullYear()) -
            //                    parseInt(bDateVal.slice(6))) < 18)
            //        { inputInvalid('birthdate', 'msgBDateError', 'You must be over 17 years old'); }
            //        else if (parseInt((new Date().getFullYear()) -
            //                    parseInt(bDateVal.slice(6))) > 200)
            //        { inputInvalid('birthdate', 'msgBDateError', 'Is this correct?'); }
            //        else {
            //            inputValid('birthdate', 'msgBDateError');
            //            bdate = true;
            //        }
            //    }
            //});
        })
    }
</script>
<style>
    div#todaystasks {
        padding: 0;
    }
    div#todaystasks > div {
        margin: 10px 0;
        padding: 0;
    }
    div#todaystasks > div > div {
        margin: 0 auto;
    }
    div#todaystasks > div > div,
    div#todaystasks > div > div > div {
        padding: 0;
    }
    div#todaystasks > div > div > div > div {
        padding: 5px 0;
    }
    div#todaystasks > div > div > div > div.col-xs-2,
    div#todaystasks > div > div > div > div.col-xs-3 {
        padding-top: 10px 
    }
    .add-task-content > form > div:last-of-type {
        border: none;
        box-shadow: none;
        text-align: right;
        padding: 10px 0 0 0;
    }
</style>

@model DailyTaskReport.Models.user_tasks
<div class="container" style="padding: 0px;">
    @Html.TextBoxFor(m => m.user, new { @style = "display: none;", Value = @Session["_user"] })
    <div class="col-xs-6" style="padding: 0px;">
        <div>
            <div class="col-xs-3" style="padding: 0px;">
                <b>Date</b>
            </div>
            <div class="col-xs-9" style="padding: 0px;">
                @Html.TextBoxFor(m => m.tasks[0].task_date, new { @type = "date", @maxlength = 10, placeholder = "mm/dd/yyyy" })
            </div>
        </div>
    </div>
</div>
<div id="todaystasks" class="container">
    <div class="container">
        <div class="col-xs-6 container">
            <div class="col-xs-12 container">
                <div class="col-xs-3">
                    Time
                </div>
                <div class="col-xs-9">
                    @Html.TextBoxFor(m => m.tasks[0].taskLists[0].timeFrom, new { @type = "time", @style = "width: 40%;" })
                    ─
                    @Html.TextBoxFor(m => m.tasks[0].taskLists[0].timeTo, new { @type = "time", @style = "width: 40%;" })
                </div>
            </div>

            <div class="col-xs-12 container">
                <div class="col-xs-3">
                    Work Order
                </div>
                <div class="col-xs-9">
                    @Html.TextBoxFor(m => m.tasks[0].taskLists[0].woNo, new { @maxlength = "18", @placeholder = "work order no.", @style = "text-transform: uppercase; width: 86%; text-align: center;" })
                </div>
            </div>
        </div>
        <div class="col-xs-6 container">
            <div class="container">
                <div class="col-xs-2">
                    Task
                </div>
                <div class="col-xs-10">
                    @Html.TextAreaFor(m => m.tasks[0].taskLists[0].task, new { @placeholder = "description", @style = "width: 100%; height: 100%; padding: 10px; resize: none;" })
                </div>
            </div>
        </div>
    </div>
</div>
<div class="add-task-bottons">
    <button id="addTimeLine" class="bgcred fontWhite" type="button"
            style="margin-right: 10px;">
        Add Time Line
    </button>
    <button class="bgcred fontWhite" type="submit">Submit</button>
</div>
@model DailyTaskReport.Models.user_tasks
<style>
    .add-task-holder {
        /*border-radius: 10px;*/
        max-width: 1000px;
        overflow: hidden;
        margin: 0 auto;
    }
    .add-task-holder > div:first-child {
        /*background-color: #ca0f0f;*/
        background-color: #821616;
        display: inline-block;
        font-size: 16px;
        color: white;
        padding: 10px 20px;
    }
    .add-task-content {
        color: black;
        background-color: rgba(255,198,198, 0.4);
        border-top-right-radius: 100px;
        border-bottom-left-radius: 100px;
    }
    .add-task-content > form > div:first-child {
        padding: 5px 10px;
        display: inline-block;
        /*background-color: #eab9b9;*/
        /*border: 1px solid #2e0905;*/
        border-bottom: none;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        border-bottom-left-radius: 0px;
        border-bottom-right-radius: 0px;
    }
    .add-task-content > form {
        padding: 20px;
    }
    .add-task-content > form > div#todaystasks {
        /*display: block;*/
        /*border: 1px solid #2e0905;*/
        border-top-right-radius: 5px;
        border-bottom-left-radius: 5px;
        border-bottom-right-radius: 5px;
        /*box-shadow: rgba(0,0,0,0.4) 0px 0px 15px 1px;*/
    }
    div#todaystasks > div {
        /*margin: 0 auto;*/
        padding: 10px 0;
        
    }
    /*div#todaystasks > div > div {
        padding: 0;
    }
    div#todaystasks > div > div > div {
        padding-top: 10px;
        padding-bottom: 10px;
        display: inline-block;
    }
    div#todaystasks > div > div > div > input[type=time] {
        width: 100px;
    }*/
    div#todaystasks > div:before,
    div#todaystasks > div:after {
        display: table;
        content: " ";
    }
    div#todaystasks > div:after {
        clear: both;
    }
    
    div#todaystasks > div:nth-child(2n) {
        background-color: rgba(190,50,50,0.2);
    }
    .add-task-content > form > div:last-child {
        border: none;
        box-shadow: none;
        text-align: right;
        padding: 10px 0 0 0;
    }
</style>

<div class="add-task-holder">
    <div> Add Task </div>
    <div class="add-task-content">
        @using (Html.BeginForm("addTasks", "Task", FormMethod.Post, new { @id = "frmAddTask", @class = "add-task-content" }))
        {
            <div>
                @Html.TextBoxFor(m => m.user, new { @style = "display: none;", Value = @Session["_user"] })
                <b>Date</b> : @Html.TextBoxFor(m => m.tasks[0].task_date, new { @type = "date" })
            </div>
            <div id="todaystasks">
                <div class="col-md-12">
                    <div class="col-md-8">
                        <div class="col-xs-6">
                            Time
                                 : @Html.TextBoxFor(m => m.tasks[0].taskLists[0].timeFrom, new { @type = "time" })
                                 ─ @Html.TextBoxFor(m => m.tasks[0].taskLists[0].timeTo, new { @type = "time" })
                        </div>
                        <div class="col-xs-6">
                            Work Order : @Html.TextBoxFor(m => m.tasks[0].taskLists[0].woNo, new { @maxlength = "18" })
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="col-md-12">
                            Task : 
                            @Html.TextBoxFor(m => m.tasks[0].taskLists[0].task, new { @placeholder = "description" })
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <button id="addTimeList" class="bgcred fontWhite" type="button"
                        style="margin-right: 10px;">Add Time Line</button>
                <button class="bgcred fontWhite" type="submit">Submit</button>
            </div>
        }
    </div>
</div>

<script>
    $(function () {
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();
        if(dd<10) dd='0'+dd;
        if (mm < 10) mm = '0' + mm;
        var today = yyyy+'-'+mm+'-'+dd;
        document.getElementById('dateTime').value = today;

        $('#frmAddTask').on("submit", function (e) {
            e.preventDefault();
            $.ajax({
                async: true,
                type: 'POST',
                url: $(this).attr("action"),
                data: $('form :input').serializeArray(),
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                dataType: 'json',
                cache: false,
                success: function (response) {
                    if (response.code == 1) {
                        alert(response.message);
                        $('#body-content').html("");
                    }
                    else if (response.code == 0) {
                        alert(response.message);
                    }
                },
                error: function () {
                    alert('an error has occured');
                }
            });
        });

        var ListCount = 0;
        $('#addTimeList').on("click", function (e) {
            if ($('input#taskLists_' + ListCount + '__timeFrom').val() != "" 
               && $('input#taskLists_' + ListCount + '__timeTo').val() != ""
               && $('input#taskLists_' + ListCount + '__task').val() != "") {
                ListCount++;
                var timeForm = '<div class="col-md-12"><div class="col-md-8"><div class="col-xs-6">'
                             + 'Time : <input id="taskLists_' + ListCount + '__timeFrom" name="taskLists[' + ListCount + '].timeFrom" type="time" value="">'
                             + '     ─ <input id="taskLists_' + ListCount + '__timeTo" name="taskLists[' + ListCount + '].timeTo" type="time" value="">'
                             + '</div><div class="col-xs-6">'
                             + 'Work Order : <input id="taskLists_' + ListCount + '__woNo" name="taskLists[' + ListCount + '].woNo" type="text" value="">'
                             + '</div></div><div class="col-md-4"><div class="col-md-12">'
                             + 'Task : <input id="taskLists_' + ListCount + '__task" name="taskLists[' + ListCount + '].task" type="text" value="" placeholder = "description">'
                             + '</div></div></div>';
                document.getElementById('todaystasks').insertAdjacentHTML('beforeend', timeForm);
            }
            else {
                alert("Fill out the form first");
            }
        });
    });
</script>